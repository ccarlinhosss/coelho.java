<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Jogo do Coelho Animado</title>
<style>
  body {
    background: #87CEEB;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    font-family: Arial, sans-serif;
  }

  canvas {
    border: 4px solid white;
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    background: linear-gradient(#3cb371, #2e8b57);
  }

  #score, #timer, #level, #goal {
    position: absolute;
    left: 20px;
    font-size: 22px;
    color: #fff;
    text-shadow: 1px 1px 3px black;
  }
  #score { top: 20px; }
  #timer { top: 55px; }
  #level { top: 90px; }
  #goal { top: 125px; }

  #reset {
    position: absolute;
    top: 20px;
    right: 20px;
    padding: 8px 16px;
    background: white;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }
  #reset:hover { background: #eee; }
</style>
</head>
<body>
<div id="score">Pontua√ß√£o: 0</div>
<div id="timer">Tempo: 0</div>
<div id="level">N√≠vel: 1</div>
<div id="goal">Meta: 200 pontos</div>
<button id="reset">üîÑ Reiniciar</button>
<canvas id="gameCanvas" width="700" height="650"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const gridSize = 30;
const tileCount = canvas.width / gridSize;

// Jogador com pulinhos
let coelho = { x: 5, y: 5, px: 5*gridSize, py: 5*gridSize, salto: 0 };

// Itens
let cenouras = [];
let morangos = [];

// Decora√ß√µes (nuvens)
let decoracoes = [];
let score = 0;

// N√≠veis
let nivel = 1;
let tempoRestante = 60; 
let intervalTimer;

const niveis = {
  1: { pontos: 200, tempo: 60 },
  2: { pontos: 450, tempo: 120 },
  3: { pontos: 800, tempo: 180 }
};

// Gerar itens
function gerarItemArray(array, emoji, quantidade){
  array.length = 0;
  for(let i=0;i<quantidade;i++){
    array.push({
      x: Math.floor(Math.random() * tileCount),
      y: Math.floor(Math.random() * tileCount),
      tipo: emoji
    });
  }
}

// Atualizar HUD
function atualizarHUD() {
  document.getElementById("score").innerText = "Pontua√ß√£o: " + score;
  document.getElementById("timer").innerText = "Tempo: " + tempoRestante + "s";
  document.getElementById("level").innerText = "N√≠vel: " + nivel;
  document.getElementById("goal").innerText = "Meta: " + niveis[nivel].pontos + " pontos";
}

// Resetar n√≠vel
function resetarNivel(){
  coelho = { x: 5, y: 5, px: 5*gridSize, py: 5*gridSize, salto: 0 };
  gerarItemArray(cenouras, "ü•ï", 7);
  gerarItemArray(morangos, "üçì", 5);
  tempoRestante = niveis[nivel].tempo;
  score = 0;
  atualizarHUD();

  clearInterval(intervalTimer);
  intervalTimer = setInterval(()=>{
    tempoRestante--;
    atualizarHUD();

    if(tempoRestante <= 0){
      if(score >= niveis[nivel].pontos){
        if(nivel < 3){
          nivel++;
          resetarNivel();
        } else {
          alert("üéâ Parab√©ns! Voc√™ completou todos os n√≠veis! Pontua√ß√£o final: "+score);
          nivel = 1;
          resetarNivel();
        }
      } else {
        alert("‚è≥ Tempo esgotado! Recome√ßando n√≠vel "+nivel);
        resetarNivel();
      }
    }
  },1000);
}

// Decora√ß√µes (nuvens)
for(let i=0;i<10;i++){
  decoracoes.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height/3,
    tipo: "‚òÅÔ∏è",
    speed: 0.3 + Math.random()*0.5
  });
}

// Controle de movimento
let dx=0, dy=0;
document.addEventListener("keydown", e=>{
  if(e.key==="ArrowUp"||e.key==="w"){dx=0; dy=-1;}
  if(e.key==="ArrowDown"||e.key==="s"){dx=0; dy=1;}
  if(e.key==="ArrowLeft"||e.key==="a"){dx=-1; dy=0;}
  if(e.key==="ArrowRight"||e.key==="d"){dx=1; dy=0;}
});

// Bot√£o Reset
document.getElementById("reset").onclick = ()=>{
  nivel = 1;
  resetarNivel();
};

// Fundo
function desenharFundo(){
  const grad = ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0,"#3cb371");
  grad.addColorStop(1,"#2e8b57");
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,canvas.width,canvas.height);
}

// Loop do jogo
let startTime = performance.now();
function gameLoop(timestamp){
  // Movimento suave
  coelho.px += (coelho.x*gridSize - coelho.px)*0.2;
  coelho.py += (coelho.y*gridSize - coelho.py)*0.2;

  // efeito de pulo confi√°vel usando performance.now()
  coelho.salto = Math.sin(timestamp/150)*5;

  desenharFundo();

  // Decora√ß√µes
  decoracoes.forEach(d=>{
    ctx.font="28px Arial";
    ctx.fillText(d.tipo, d.x, d.y);
    d.x += d.speed;
    if(d.x>canvas.width)d.x=-50;
  });

  // Itens
  ctx.font="28px Arial";
  cenouras.forEach(c=>ctx.fillText(c.tipo, c.x*gridSize, c.y*gridSize+gridSize));
  morangos.forEach(m=>ctx.fillText(m.tipo, m.x*gridSize, m.y*gridSize+gridSize));

  // Coelho
  ctx.font="28px Arial";
  ctx.fillText("üêá", coelho.px, coelho.py + gridSize - coelho.salto);

  // Movimento
  coelho.x += dx;
  coelho.y += dy;
  dx=0; dy=0;

  if(coelho.x<0) coelho.x=0;
  if(coelho.y<0) coelho.y=0;
  if(coelho.x>=tileCount) coelho.x=tileCount-1;
  if(coelho.y>=tileCount) coelho.y=tileCount-1;

  // Colis√µes
  cenouras.forEach((c,i)=>{
    if(c.x===coelho.x && c.y===coelho.y){
      score += 5;
      cenouras[i] = {x: Math.floor(Math.random()*tileCount), y: Math.floor(Math.random()*tileCount), tipo:"ü•ï"};
    }
  });
  morangos.forEach((m,i)=>{
    if(m.x===coelho.x && m.y===coelho.y){
      score += 10;
      morangos[i] = {x: Math.floor(Math.random()*tileCount), y: Math.floor(Math.random()*tileCount), tipo:"üçì"};
    }
  });

  atualizarHUD();

  // Passar de n√≠vel automaticamente
  if(score >= niveis[nivel].pontos){
    if(nivel < 3){
      nivel++;
      resetarNivel();
    } else {
      alert("üéâ Parab√©ns! Voc√™ completou todos os n√≠veis! Pontua√ß√£o final: "+score);
      nivel = 1;
      resetarNivel();
    }
  }

  requestAnimationFrame(gameLoop);
}

// Inicia o jogo
resetarNivel();
requestAnimationFrame(gameLoop);
</script>
</body>
</html>
